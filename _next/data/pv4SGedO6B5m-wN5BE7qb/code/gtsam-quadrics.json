{"pageProps":{"codeData":{"content":"<p align=\"center\"><strong>~ Please see our <a href=\"https://github.com/qcr/quadricslam\">QuadricSLAM repository</a> for examples of full SLAM systems~</strong></p>\n<h1>GTSAM Quadrics: quadric landmarks for GTSAM</h1>\n<p><a href=\"https://qcr.github.io\"><picture><img alt=\"QUT Centre for Robotics Open Source\" src=\"https://github.com/qcr/qcr.github.io/raw/master/misc/badge.svg\"></picture></a>\n<a href=\"https://roboticvision.org/best-of-acrv\"><picture><img alt=\"Best of ACRV Repository\" src=\"https://img.shields.io/badge/collection-best--of--acrv-%23a31b2a\"></picture></a>\n<picture><img alt=\"Primary language\" src=\"https://img.shields.io/github/languages/top/qcr/gtsam-quadrics\"></picture>\n<a href=\"https://pypi.org/project/gtsam-quadrics/\"><picture><img alt=\"PyPI package\" src=\"https://img.shields.io/pypi/pyversions/gtsam-quadrics\"></picture></a>\n<a href=\"./LICENSE.txt\"><picture><img alt=\"License\" src=\"https://img.shields.io/github/license/qcr/gtsam-quadrics\"></picture></a></p>\n<p>This repository contains an extension to the popular <a href=\"https://github.com/borglab/gtsam\">Georgia Tech Smoothing and Mapping (GTSAM)</a> factor graph optimisation library. We introduce constrained dual quadrics as GTSAM variables, and support the estimation of the quadric parameters using 2-D bounding box measurements. These tools are available in both C++ and Python, and are designed to be used in conjunction with GTSAM. The extensions power our <a href=\"https://github.com/qcr/quadricslam\">QuadricSLAM library</a>, where we use quadrics for simultaneous localisation and mapping (SLAM) problems.</p>\n<p><picture><img alt=\"Demonstrations of GTSAM Quadrics in action\" src=\"https://github.com/qcr/gtsam-quadrics/raw/master/doc/gtsam_quadrics.png\"></picture></p>\n<p>We expect this repository to be active and continually improved upon. If you have any feature requests or experience any bugs, don't hesitate to let us know. Our code is free to use, and licensed under BSD-3. We simply ask that you <a href=\"#citing-our-work\">cite our work</a> if you use QuadricSLAM in your own research.</p>\n<h2>Installation</h2>\n<p><em>Note: we are aware of <a href=\"https://github.com/qcr/gtsam-quadrics/issues/24\">some issues</a> with the wheels. If you encounter issues, we recommend the \"Install from source via Pip\" steps below</em></p>\n<p>Pre-build wheels of this library are <a href=\"https://pypi.org/project/gtsam-quadrics/\">available on PyPI</a> for most Linux systems, as well as source distributions. Install the library with:</p>\n<pre><code>pip install gtsam_quadrics\n</code></pre>\n<p>The Python library is built from a <a href=\"/setup.py\">custom <code>setup.py</code></a>, which uses CMake to build a custom C++ extension bound using both <a href=\"https://github.com/pybind/pybind11\">PyBind11</a> and Georgia Tech's <a href=\"https://github.com/borglab/wrap\">wrap meta-library</a>.</p>\n<h3>Building from source</h3>\n<p>You can build from source if you want closer access to the C++ libraries, or are having trouble finding a pre-compiled wheel for your system. There are two levels you can build the package from source: the Python level using pip, and C++ level using CMake.</p>\n<p>All building from source methods expect the following system dependencies to be available:</p>\n<ul>\n<li>A C++ compiler</li>\n<li>CMake &gt;= 3.18</li>\n<li>Boost C++ libraries &gt;= 1.65</li>\n<li>METIS matrix library</li>\n</ul>\n<p>Instructions for installing these dependencies vary across Linux systems, but the following should be sufficient on a relatively recent Ubuntu version:</p>\n<pre><code>sudo apt install build-essential cmake libboost-all-dev libmetis-dev\n</code></pre>\n<p>If your distribution's CMake version is too old, it can easily be upgrade following Kitware's instructions <a href=\"https://apt.kitware.com/\">here</a>.</p>\n<p><strong>Install from source via Pip</strong></p>\n<p>Simply request the <code>sdist</code> instead of binary wheel:</p>\n<pre><code>pip install gtsam_quadrics --no-binary :all:\n</code></pre>\n<p><strong>Building the Python package from source</strong></p>\n<p>Installing from source is very similar to the <code>pip</code> method above, accept installation is from a local copy:</p>\n<ol>\n<li>\n<p>Clone the repository, and initialise the <code>gtsam</code> submodule:</p>\n<pre><code>git clone --recurse-submodules https://github.com/best-of-acrv/gtsam-quadrics\n</code></pre>\n</li>\n<li>\n<p>Enter the <code>gtsam_quadrics</code> directory, and simply install via <code>pip</code> (the build process will take a while):</p>\n<pre><code>pip install .\n</code></pre>\n</li>\n</ol>\n<p><strong>Building the C++ package with CMake</strong></p>\n<ol>\n<li>\n<p>Clone the repository, and initialise the <code>gtsam</code> submodule:</p>\n<pre><code>git clone --recurse-submodules https://github.com/best-of-acrv/gtsam-quadrics\n</code></pre>\n</li>\n<li>\n<p>Create an out-of-source build directory:</p>\n<pre><code>cd gtsam_quadrics\nmkdir build\ncd build\n</code></pre>\n</li>\n<li>\n<p>Run the configuration and generation CMake steps, optionally building the Python wrapper using the <code>BUILD_PYTHON_WRAP</code> variable:</p>\n<pre><code>cmake -DBUILD_PYTHON_WRAP=ON ..\n</code></pre>\n</li>\n<li>\n<p>Run the build step:</p>\n<pre><code>cmake --build . -j$(nproc)\n</code></pre>\n</li>\n</ol>\n<p>Then optionally run any of the other supported targets as described below:</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\"><strong>Target name</strong></th>\n<th style=\"text-align:left\"><strong>Description</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">check</td>\n<td style=\"text-align:left\">compile and run optional unit tests</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">examples</td>\n<td style=\"text-align:left\">compiles the c++ examples</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">doc</td>\n<td style=\"text-align:left\">generates the doxygen documentation</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">doc_clean</td>\n<td style=\"text-align:left\">removes the doxygen documentation</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">install</td>\n<td style=\"text-align:left\">installs the gtsam_quadrics c++/python library</td>\n</tr>\n</tbody>\n</table>\n<p><em>Note: documentation requires Doxygen (<code>sudo apt install doxygen</code>) and epstopdf (<code>sudo apt install texlive-font-utils</code>)</em></p>\n<h2>Using the GTSAM Quadrics and GTSAM Python APIs</h2>\n<p>GTSAM Quadrics and GTSAM can be used like native Python packages. Below are some examples to help get you started with using GTSAM Quadrics:</p>\n<pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> gtsam\n<span class=\"token keyword\">import</span> gtsam_quadrics\n<span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n\n<span class=\"token comment\"># setup constants</span>\npose_key <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>gtsam<span class=\"token punctuation\">.</span>symbol<span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'x'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nquadric_key <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>gtsam<span class=\"token punctuation\">.</span>symbol<span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'q'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># create calibration</span>\ncalibration <span class=\"token operator\">=</span> gtsam<span class=\"token punctuation\">.</span>Cal3_S2<span class=\"token punctuation\">(</span><span class=\"token number\">525.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">525.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">160.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">120.0</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># create graph/values</span>\ngraph <span class=\"token operator\">=</span> gtsam<span class=\"token punctuation\">.</span>NonlinearFactorGraph<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nvalues <span class=\"token operator\">=</span> gtsam<span class=\"token punctuation\">.</span>Values<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># create noise model (SD=10)</span>\nbbox_noise <span class=\"token operator\">=</span> gtsam<span class=\"token punctuation\">.</span>noiseModel_Diagonal<span class=\"token punctuation\">.</span>Sigmas<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token operator\">*</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> dtype<span class=\"token operator\">=</span>np<span class=\"token punctuation\">.</span><span class=\"token builtin\">float</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># create quadric landmark (pose=eye(4), radii=[1,2,3])</span>\ninitial_quadric <span class=\"token operator\">=</span> gtsam_quadrics<span class=\"token punctuation\">.</span>ConstrainedDualQuadric<span class=\"token punctuation\">(</span>gtsam<span class=\"token punctuation\">.</span>Pose3<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">1.</span><span class=\"token punctuation\">,</span><span class=\"token number\">2.</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># create bounding-box measurement (xmin,ymin,xmax,ymax)</span>\nbounds <span class=\"token operator\">=</span> gtsam_quadrics<span class=\"token punctuation\">.</span>AlignedBox2<span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span><span class=\"token number\">25</span><span class=\"token punctuation\">,</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># create bounding-box factor</span>\nbbf <span class=\"token operator\">=</span> gtsam_quadrics<span class=\"token punctuation\">.</span>BoundingBoxFactor<span class=\"token punctuation\">(</span>bounds<span class=\"token punctuation\">,</span> calibration<span class=\"token punctuation\">,</span> pose_key<span class=\"token punctuation\">,</span> quadric_key<span class=\"token punctuation\">,</span> bbox_noise<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># add landmark to values</span>\ninitial_quadric<span class=\"token punctuation\">.</span>addToValues<span class=\"token punctuation\">(</span>values<span class=\"token punctuation\">,</span> quadric_key<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># add bbf to graph</span>\ngraph<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>bbf<span class=\"token punctuation\">)</span>\n\n\n<span class=\"token comment\"># get quadric estimate from values (assuming the values have changed)</span>\nquadric_estimate <span class=\"token operator\">=</span> gtsam_quadrics<span class=\"token punctuation\">.</span>ConstrainedDualQuadric<span class=\"token punctuation\">.</span>getFromValues<span class=\"token punctuation\">(</span>values<span class=\"token punctuation\">,</span> quadric_key<span class=\"token punctuation\">)</span>\n</code></pre>\n<h2>Citing our work</h2>\n<p>If you are using this library in academic work, please cite the <a href=\"https://ieeexplore.ieee.org/document/8440105\">publication</a>:</p>\n<p>L. Nicholson, M. Milford and N. Sünderhauf, \"QuadricSLAM: Dual Quadrics From Object Detections as Landmarks in Object-Oriented SLAM,\" in IEEE Robotics and Automation Letters, vol. 4, no. 1, pp. 1-8, Jan. 2019, doi: 10.1109/LRA.2018.2866205. <a href=\"https://arxiv.org/abs/1804.04011\">PDF</a>.</p>\n<pre class=\"language-bibtex\"><code class=\"language-bibtex\">@article{nicholson2019,\n  title={QuadricSLAM: Dual Quadrics From Object Detections as Landmarks in Object-Oriented SLAM},\n  author={Nicholson, Lachlan and Milford, Michael and Sünderhauf, Niko},\n  journal={IEEE Robotics and Automation Letters},\n  year={2019},\n}\n</code></pre>\n","name":"GTSAM extension for quadrics","type":"code","url":"https://github.com/qcr/gtsam-quadrics","image":"https://github.com/qcr/gtsam-quadrics/raw/master/doc/gtsam_quadrics.png","_images":["/_next/static/images/gtsam_quadrics-9ce945399d611f449b8df8e1db6602ae.png.webp","/_next/static/images/gtsam_quadrics-cb27c37d5d64abed2e30e1523a8cec1a.png"],"src":"/content/quadricslam/gtsam_quadrics.md","id":"gtsam-quadrics","image_position":"center"}},"__N_SSG":true}